<Window x:Class="HeyGPT.Views.UserGuideWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="User Guide Â· ä½¿ç”¨ã‚¬ã‚¤ãƒ‰ Â· ì‚¬ìš© ì„¤ëª…ì„œ"
        Height="700" Width="900"
        WindowStartupLocation="CenterScreen"
        Background="{StaticResource TraditionalGradientBrush}">

    <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="40,32">
        <StackPanel>
            <!-- Header -->
            <TextBlock Text="ðŸ“–"
                       FontSize="48"
                       HorizontalAlignment="Center"
                       Margin="0,0,0,16"/>

            <TextBlock Style="{StaticResource HeaderText}"
                       FontSize="32"
                       HorizontalAlignment="Center"
                       Margin="0,0,0,12">
                <Run Text="Complete" Foreground="{StaticResource PrimaryBrush}"/>
                <Run Text="User Guide" Foreground="{StaticResource TextPrimaryBrush}"/>
            </TextBlock>

            <Border Height="2"
                    Width="120"
                    Background="{StaticResource AccentBrush}"
                    CornerRadius="1"
                    Opacity="0.7"
                    Margin="0,0,0,32"/>

            <!-- Quick Start Section -->
            <Border Style="{StaticResource WabiSabiCard}" Margin="0,0,0,24">
                <StackPanel>
                    <TextBlock Text="ðŸš€ Quick Start Guide"
                               Style="{StaticResource HeaderText}"
                               FontSize="24"
                               Foreground="{StaticResource PrimaryBrush}"
                               Margin="0,0,0,16"/>

                    <TextBlock Style="{StaticResource SubheaderText}"
                               Text="Step 1: Configure Your Monitor"
                               FontSize="16"
                               Margin="0,0,0,8"/>
                    <TextBlock Style="{StaticResource BodyText}"
                               TextWrapping="Wrap"
                               Margin="0,0,0,16">
                        <Run Text="1. Open Settings window"/>
                        <LineBreak/>
                        <Run Text="2. Click 'Configure Monitor (10s countdown)'"/>
                        <LineBreak/>
                        <Run Text="3. Move your mouse to the center of your desired monitor"/>
                        <LineBreak/>
                        <Run Text="4. Wait 10 seconds - position will be captured automatically"/>
                        <LineBreak/>
                        <Run Text="5. Monitor info will update to show selected monitor"/>
                    </TextBlock>

                    <TextBlock Style="{StaticResource SubheaderText}"
                               Text="Step 2: Capture Button Positions"
                               FontSize="16"
                               Margin="0,0,0,8"/>
                    <TextBlock Style="{StaticResource BodyText}"
                               TextWrapping="Wrap"
                               Margin="0,0,0,16">
                        <Run Text="1. Launch ChatGPT desktop app manually first"/>
                        <LineBreak/>
                        <Run Text="2. In Settings, click 'Capture New Chat Button'"/>
                        <LineBreak/>
                        <Run Text="3. Hover your mouse over the 'New chat' button in ChatGPT"/>
                        <LineBreak/>
                        <Run Text="4. Wait 10 seconds until position is captured"/>
                        <LineBreak/>
                        <Run Text="5. Repeat for 'Capture Voice Mode Button'"/>
                        <LineBreak/>
                        <Run Text="6. Hover over the Voice Mode button (usually bottom-right corner)"/>
                    </TextBlock>

                    <TextBlock Style="{StaticResource SubheaderText}"
                               Text="Step 3: Configure Wake Word"
                               FontSize="16"
                               Margin="0,0,0,8"/>
                    <TextBlock Style="{StaticResource BodyText}"
                               TextWrapping="Wrap"
                               Margin="0,0,0,16">
                        <Run Text="1. Set your custom wake word (default: 'Hey GPT')"/>
                        <LineBreak/>
                        <Run Text="2. Adjust Speech Confidence Threshold (0.5-1.0, default: 0.7)"/>
                        <LineBreak/>
                        <Run Text="3. Configure Advanced Isolation settings (see below)"/>
                        <LineBreak/>
                        <Run Text="4. Click 'Save Settings'"/>
                    </TextBlock>

                    <TextBlock Style="{StaticResource SubheaderText}"
                               Text="Step 4: Test &amp; Use"
                               FontSize="16"
                               Margin="0,0,0,8"/>
                    <TextBlock Style="{StaticResource BodyText}"
                               TextWrapping="Wrap">
                        <Run Text="1. Click 'Test Launch' to verify automation works"/>
                        <LineBreak/>
                        <Run Text="2. If successful, click 'Start' to begin listening"/>
                        <LineBreak/>
                        <Run Text="3. Say your wake word clearly: 'Hey GPT'"/>
                        <LineBreak/>
                        <Run Text="4. Watch as ChatGPT launches and voice mode activates!"/>
                        <LineBreak/>
                        <Run Text="5. Monitor the Activity Log for real-time feedback"/>
                    </TextBlock>
                </StackPanel>
            </Border>

            <!-- Wake Word Isolation Section -->
            <Border Style="{StaticResource WabiSabiCard}" Margin="0,0,0,24">
                <StackPanel>
                    <TextBlock Text="ðŸ›¡ï¸ Advanced Wake Word Isolation"
                               Style="{StaticResource HeaderText}"
                               FontSize="24"
                               Foreground="{StaticResource PrimaryBrush}"
                               Margin="0,0,0,16"/>

                    <TextBlock Style="{StaticResource BodyText}"
                               TextWrapping="Wrap"
                               Margin="0,0,0,16">
                        <Run Text="The isolation system prevents false positives by ensuring your wake word is spoken in isolation, not within another sentence. This dramatically reduces unwanted activations."
                             FontWeight="SemiBold"/>
                    </TextBlock>

                    <TextBlock Style="{StaticResource SubheaderText}"
                               Text="ðŸŽšï¸ Silence Threshold (0-30)"
                               FontSize="16"
                               Margin="0,0,0,8"/>
                    <TextBlock Style="{StaticResource BodyText}"
                               TextWrapping="Wrap"
                               Margin="0,0,0,16">
                        <Run Text="â€¢ Audio levels below this value are considered 'silence'"/>
                        <LineBreak/>
                        <Run Text="â€¢ Default: 10 (suitable for quiet environments)"/>
                        <LineBreak/>
                        <Run Text="â€¢ Increase (15-20) for noisy environments"/>
                        <LineBreak/>
                        <Run Text="â€¢ Decrease (5-8) for very quiet rooms"/>
                        <LineBreak/>
                        <Run Text="â€¢ Too high = may miss wake word, Too low = false positives"/>
                    </TextBlock>

                    <TextBlock Style="{StaticResource SubheaderText}"
                               Text="â±ï¸ Minimum Silence Duration (ms)"
                               FontSize="16"
                               Margin="0,0,0,8"/>
                    <TextBlock Style="{StaticResource BodyText}"
                               TextWrapping="Wrap"
                               Margin="0,0,0,16">
                        <Run Text="â€¢ Required silence period BEFORE saying wake word"/>
                        <LineBreak/>
                        <Run Text="â€¢ Default: 800ms (0.8 seconds)"/>
                        <LineBreak/>
                        <Run Text="â€¢ Recommended range: 500-1500ms"/>
                        <LineBreak/>
                        <Run Text="â€¢ Prevents wake word detection mid-sentence"/>
                        <LineBreak/>
                        <Run Text="â€¢ Increase if you get 'embedded in longer phrase' rejections"/>
                    </TextBlock>

                    <TextBlock Style="{StaticResource SubheaderText}"
                               Text="â²ï¸ Cooldown Period (ms)"
                               FontSize="16"
                               Margin="0,0,0,8"/>
                    <TextBlock Style="{StaticResource BodyText}"
                               TextWrapping="Wrap"
                               Margin="0,0,0,16">
                        <Run Text="â€¢ Minimum time between wake word activations"/>
                        <LineBreak/>
                        <Run Text="â€¢ Default: 2500ms (2.5 seconds)"/>
                        <LineBreak/>
                        <Run Text="â€¢ Recommended range: 2000-5000ms"/>
                        <LineBreak/>
                        <Run Text="â€¢ Prevents rapid repeated false triggers"/>
                        <LineBreak/>
                        <Run Text="â€¢ Increase if you experience double-triggering"/>
                    </TextBlock>

                    <Border Background="{StaticResource MistBrush}"
                            CornerRadius="8"
                            Padding="16"
                            Margin="0,8,0,0">
                        <TextBlock Style="{StaticResource BodyText}" TextWrapping="Wrap">
                            <Run Text="ðŸ’¡ Pro Tip: " FontWeight="Bold" Foreground="{StaticResource PrimaryBrush}"/>
                            <Run Text="Start with defaults, then adjust based on Activity Log rejection messages. The system tells you exactly why it rejected a detection!"/>
                        </TextBlock>
                    </Border>
                </StackPanel>
            </Border>

            <!-- Environment Presets Section -->
            <Border Style="{StaticResource WabiSabiCard}" Margin="0,0,0,24">
                <StackPanel>
                    <TextBlock Text="ðŸŽ¯ Recommended Settings by Environment"
                               Style="{StaticResource HeaderText}"
                               FontSize="24"
                               Foreground="{StaticResource PrimaryBrush}"
                               Margin="0,0,0,16"/>

                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Headers -->
                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Setting" FontWeight="Bold" Margin="8"/>
                        <TextBlock Grid.Row="0" Grid.Column="1" Text="Quiet Office" FontWeight="Bold" Margin="8"/>
                        <TextBlock Grid.Row="0" Grid.Column="2" Text="Noisy Home" FontWeight="Bold" Margin="8"/>

                        <!-- Silence Threshold -->
                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Silence Threshold" Margin="8"/>
                        <TextBlock Grid.Row="1" Grid.Column="1" Text="5-8" Margin="8" Foreground="{StaticResource SecondaryBrush}"/>
                        <TextBlock Grid.Row="1" Grid.Column="2" Text="15-25" Margin="8" Foreground="{StaticResource AccentBrush}"/>

                        <!-- Min Silence -->
                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Min Silence (ms)" Margin="8"/>
                        <TextBlock Grid.Row="2" Grid.Column="1" Text="500-700" Margin="8" Foreground="{StaticResource SecondaryBrush}"/>
                        <TextBlock Grid.Row="2" Grid.Column="2" Text="1000-1500" Margin="8" Foreground="{StaticResource AccentBrush}"/>

                        <!-- Cooldown -->
                        <TextBlock Grid.Row="3" Grid.Column="0" Text="Cooldown (ms)" Margin="8"/>
                        <TextBlock Grid.Row="3" Grid.Column="1" Text="2000-2500" Margin="8" Foreground="{StaticResource SecondaryBrush}"/>
                        <TextBlock Grid.Row="3" Grid.Column="2" Text="3000-4000" Margin="8" Foreground="{StaticResource AccentBrush}"/>

                        <!-- Confidence -->
                        <TextBlock Grid.Row="4" Grid.Column="0" Text="Confidence" Margin="8"/>
                        <TextBlock Grid.Row="4" Grid.Column="1" Text="0.6-0.7" Margin="8" Foreground="{StaticResource SecondaryBrush}"/>
                        <TextBlock Grid.Row="4" Grid.Column="2" Text="0.7-0.8" Margin="8" Foreground="{StaticResource AccentBrush}"/>
                    </Grid>
                </StackPanel>
            </Border>

            <!-- Understanding Activity Log -->
            <Border Style="{StaticResource WabiSabiCard}" Margin="0,0,0,24">
                <StackPanel>
                    <TextBlock Text="ðŸ“Š Understanding the Activity Log"
                               Style="{StaticResource HeaderText}"
                               FontSize="24"
                               Foreground="{StaticResource PrimaryBrush}"
                               Margin="0,0,0,16"/>

                    <TextBlock Style="{StaticResource SubheaderText}"
                               Text="âœ“ Success Messages"
                               FontSize="16"
                               Foreground="{StaticResource SecondaryBrush}"
                               Margin="0,0,0,8"/>
                    <Border Background="{StaticResource BackgroundBrush}"
                            BorderBrush="{StaticResource SecondaryBrush}"
                            BorderThickness="2"
                            CornerRadius="8"
                            Padding="12"
                            Margin="0,0,0,16">
                        <TextBlock Style="{StaticResource BodyText}" TextWrapping="Wrap" FontFamily="Consolas">
                            <Run Text="âœ“ Wake word detected (isolated): 'Hey GPT' (confidence: 85%)" Foreground="{StaticResource SecondaryBrush}"/>
                            <LineBreak/>
                            <Run Text="âœ“ ChatGPT automation completed" Foreground="{StaticResource SecondaryBrush}"/>
                            <LineBreak/>
                            <Run Text="âœ“ Voice mode confirmed active (blue orb detected)" Foreground="{StaticResource SecondaryBrush}"/>
                        </TextBlock>
                    </Border>

                    <TextBlock Style="{StaticResource SubheaderText}"
                               Text="âš  Rejection Messages (Why Wake Word Was Ignored)"
                               FontSize="16"
                               Foreground="{StaticResource AccentBrush}"
                               Margin="0,0,0,8"/>
                    <Border Background="{StaticResource BackgroundBrush}"
                            BorderBrush="{StaticResource AccentBrush}"
                            BorderThickness="2"
                            CornerRadius="8"
                            Padding="12"
                            Margin="0,0,0,8">
                        <TextBlock Style="{StaticResource BodyText}" TextWrapping="Wrap" FontFamily="Consolas">
                            <Run Text="âš  Rejected: Cooldown period (1750ms remaining)" Foreground="{StaticResource AccentBrush}"/>
                            <LineBreak/>
                            <Run Text="   â†’ " FontWeight="Bold"/>
                            <Run Text="You said wake word too soon after last activation"/>
                            <LineBreak/>
                            <LineBreak/>
                            <Run Text="âš  Rejected: Insufficient silence before wake word (450ms &lt; 800ms)" Foreground="{StaticResource AccentBrush}"/>
                            <LineBreak/>
                            <Run Text="   â†’ " FontWeight="Bold"/>
                            <Run Text="Not enough pause before saying wake word"/>
                            <LineBreak/>
                            <LineBreak/>
                            <Run Text="âš  Rejected: Wake word embedded in longer phrase" Foreground="{StaticResource AccentBrush}"/>
                            <LineBreak/>
                            <Run Text="   â†’ " FontWeight="Bold"/>
                            <Run Text="Wake word was part of a sentence, not isolated"/>
                            <LineBreak/>
                            <LineBreak/>
                            <Run Text="Low confidence recognition: 'Hey GPT' (55%)" Foreground="{StaticResource AccentBrush}"/>
                            <LineBreak/>
                            <Run Text="   â†’ " FontWeight="Bold"/>
                            <Run Text="Speech wasn't clear enough (below confidence threshold)"/>
                        </TextBlock>
                    </Border>

                    <Border Background="{StaticResource MistBrush}"
                            CornerRadius="8"
                            Padding="16"
                            Margin="0,8,0,0">
                        <TextBlock Style="{StaticResource BodyText}" TextWrapping="Wrap">
                            <Run Text="ðŸ’¡ Use rejection messages to tune your settings! " FontWeight="Bold" Foreground="{StaticResource PrimaryBrush}"/>
                            <Run Text="If you see many 'insufficient silence' rejections, decrease Min Silence Duration. If you see 'embedded in phrase' often, you may need to speak more deliberately."/>
                        </TextBlock>
                    </Border>
                </StackPanel>
            </Border>

            <!-- Troubleshooting Section -->
            <Border Style="{StaticResource WabiSabiCard}" Margin="0,0,0,24">
                <StackPanel>
                    <TextBlock Text="ðŸ”§ Troubleshooting Common Issues"
                               Style="{StaticResource HeaderText}"
                               FontSize="24"
                               Foreground="{StaticResource PrimaryBrush}"
                               Margin="0,0,0,16"/>

                    <TextBlock Style="{StaticResource SubheaderText}"
                               Text="âŒ Problem: Wake word never detected"
                               FontSize="16"
                               Margin="0,0,0,8"/>
                    <TextBlock Style="{StaticResource BodyText}"
                               TextWrapping="Wrap"
                               Margin="0,0,0,16">
                        <Run Text="â€¢ Check microphone is connected and working"/>
                        <LineBreak/>
                        <Run Text="â€¢ Lower Speech Confidence Threshold to 0.5-0.6"/>
                        <LineBreak/>
                        <Run Text="â€¢ Temporarily disable isolation to test"/>
                        <LineBreak/>
                        <Run Text="â€¢ Speak wake word clearly and at normal volume"/>
                        <LineBreak/>
                        <Run Text="â€¢ Check Windows microphone permissions"/>
                    </TextBlock>

                    <TextBlock Style="{StaticResource SubheaderText}"
                               Text="âŒ Problem: Too many false positives"
                               FontSize="16"
                               Margin="0,0,0,8"/>
                    <TextBlock Style="{StaticResource BodyText}"
                               TextWrapping="Wrap"
                               Margin="0,0,0,16">
                        <Run Text="â€¢ Increase Speech Confidence Threshold to 0.8"/>
                        <LineBreak/>
                        <Run Text="â€¢ Increase Minimum Silence Duration to 1200-1500ms"/>
                        <LineBreak/>
                        <Run Text="â€¢ Increase Cooldown Period to 3000-4000ms"/>
                        <LineBreak/>
                        <Run Text="â€¢ Ensure Isolation is enabled"/>
                        <LineBreak/>
                        <Run Text="â€¢ Choose a more unique wake word"/>
                    </TextBlock>

                    <TextBlock Style="{StaticResource SubheaderText}"
                               Text="âŒ Problem: Buttons not clicking correctly"
                               FontSize="16"
                               Margin="0,0,0,8"/>
                    <TextBlock Style="{StaticResource BodyText}"
                               TextWrapping="Wrap"
                               Margin="0,0,0,16">
                        <Run Text="â€¢ Re-capture button positions (ChatGPT UI may have changed)"/>
                        <LineBreak/>
                        <Run Text="â€¢ Ensure ChatGPT is maximized when capturing positions"/>
                        <LineBreak/>
                        <Run Text="â€¢ Hover exactly over the center of each button"/>
                        <LineBreak/>
                        <Run Text="â€¢ Increase Button Click Delay to 1500-2000ms"/>
                        <LineBreak/>
                        <Run Text="â€¢ Make sure ChatGPT window is on the configured monitor"/>
                    </TextBlock>

                    <TextBlock Style="{StaticResource SubheaderText}"
                               Text="âŒ Problem: ChatGPT doesn't launch"
                               FontSize="16"
                               Margin="0,0,0,8"/>
                    <TextBlock Style="{StaticResource BodyText}"
                               TextWrapping="Wrap"
                               Margin="0,0,0,16">
                        <Run Text="â€¢ Verify ChatGPT desktop app is installed"/>
                        <LineBreak/>
                        <Run Text="â€¢ Test 'chatgpt' command in PowerShell or CMD"/>
                        <LineBreak/>
                        <Run Text="â€¢ If command doesn't work, use full path: "/>
                        <Run Text="C:\Users\YourName\AppData\Local\Programs\ChatGPT\ChatGPT.exe" FontFamily="Consolas"/>
                        <LineBreak/>
                        <Run Text="â€¢ Check Activity Log for specific error messages"/>
                    </TextBlock>

                    <TextBlock Style="{StaticResource SubheaderText}"
                               Text="âŒ Problem: Voice mode not activating"
                               FontSize="16"
                               Margin="0,0,0,8"/>
                    <TextBlock Style="{StaticResource BodyText}"
                               TextWrapping="Wrap">
                        <Run Text="â€¢ Verify Voice Mode button position is captured correctly"/>
                        <LineBreak/>
                        <Run Text="â€¢ Voice mode button location varies - usually bottom-right"/>
                        <LineBreak/>
                        <Run Text="â€¢ Increase Button Click Delay to allow UI to load"/>
                        <LineBreak/>
                        <Run Text="â€¢ Blue orb detection may fail - check Activity Log"/>
                        <LineBreak/>
                        <Run Text="â€¢ Manually verify voice mode works in ChatGPT first"/>
                    </TextBlock>
                </StackPanel>
            </Border>

            <!-- Best Practices Section -->
            <Border Style="{StaticResource WabiSabiCard}" Margin="0,0,0,24">
                <StackPanel>
                    <TextBlock Text="âœ¨ Best Practices for Optimal Performance"
                               Style="{StaticResource HeaderText}"
                               FontSize="24"
                               Foreground="{StaticResource PrimaryBrush}"
                               Margin="0,0,0,16"/>

                    <TextBlock Style="{StaticResource SubheaderText}"
                               Text="ðŸŽ¤ Speaking Your Wake Word"
                               FontSize="16"
                               Margin="0,0,0,8"/>
                    <TextBlock Style="{StaticResource BodyText}"
                               TextWrapping="Wrap"
                               Margin="0,0,0,16">
                        <Run Text="â€¢ Pause for 1 second before saying wake word"/>
                        <LineBreak/>
                        <Run Text="â€¢ Speak clearly at normal conversational volume"/>
                        <LineBreak/>
                        <Run Text="â€¢ Don't shout or whisper - natural speech works best"/>
                        <LineBreak/>
                        <Run Text="â€¢ Avoid saying wake word mid-sentence"/>
                        <LineBreak/>
                        <Run Text="â€¢ Wait 2-3 seconds before repeating if it didn't work"/>
                    </TextBlock>

                    <TextBlock Style="{StaticResource SubheaderText}"
                               Text="âš™ï¸ Initial Configuration"
                               FontSize="16"
                               Margin="0,0,0,8"/>
                    <TextBlock Style="{StaticResource BodyText}"
                               TextWrapping="Wrap"
                               Margin="0,0,0,16">
                        <Run Text="â€¢ Always capture button positions with ChatGPT maximized"/>
                        <LineBreak/>
                        <Run Text="â€¢ Test with 'Test Launch' button before using wake word"/>
                        <LineBreak/>
                        <Run Text="â€¢ Watch the Activity Log during first few uses"/>
                        <LineBreak/>
                        <Run Text="â€¢ Adjust settings incrementally based on results"/>
                        <LineBreak/>
                        <Run Text="â€¢ Save settings after every successful test"/>
                    </TextBlock>

                    <TextBlock Style="{StaticResource SubheaderText}"
                               Text="ðŸŽ¯ Environment Considerations"
                               FontSize="16"
                               Margin="0,0,0,8"/>
                    <TextBlock Style="{StaticResource BodyText}"
                               TextWrapping="Wrap">
                        <Run Text="â€¢ Position microphone away from speakers to avoid feedback"/>
                        <LineBreak/>
                        <Run Text="â€¢ Minimize background noise when possible"/>
                        <LineBreak/>
                        <Run Text="â€¢ Higher ambient noise requires higher Silence Threshold"/>
                        <LineBreak/>
                        <Run Text="â€¢ Test in your typical working environment"/>
                        <LineBreak/>
                        <Run Text="â€¢ Re-adjust settings if you move to different room"/>
                    </TextBlock>
                </StackPanel>
            </Border>

            <!-- Advanced Features Section -->
            <Border Style="{StaticResource WabiSabiCard}" Margin="0,0,0,24">
                <StackPanel>
                    <TextBlock Text="ðŸŽ“ Advanced Features Explained"
                               Style="{StaticResource HeaderText}"
                               FontSize="24"
                               Foreground="{StaticResource PrimaryBrush}"
                               Margin="0,0,0,16"/>

                    <TextBlock Style="{StaticResource SubheaderText}"
                               Text="ðŸ§  How Isolation Detection Works"
                               FontSize="16"
                               Margin="0,0,0,8"/>
                    <TextBlock Style="{StaticResource BodyText}"
                               TextWrapping="Wrap"
                               Margin="0,0,0,16">
                        <Run Text="The system uses multiple techniques to prevent false positives:"/>
                        <LineBreak/>
                        <LineBreak/>
                        <Run Text="1. Audio Level Monitoring:" FontWeight="Bold"/>
                        <Run Text=" Continuously tracks input volume to detect silence periods"/>
                        <LineBreak/>
                        <LineBreak/>
                        <Run Text="2. Temporal Analysis:" FontWeight="Bold"/>
                        <Run Text=" Ensures wake word is spoken within valid timing window"/>
                        <LineBreak/>
                        <LineBreak/>
                        <Run Text="3. Hypothesis Tracking:" FontWeight="Bold"/>
                        <Run Text=" Analyzes speech recognition attempts to detect embedded wake words"/>
                        <LineBreak/>
                        <LineBreak/>
                        <Run Text="4. Cooldown Protection:" FontWeight="Bold"/>
                        <Run Text=" Prevents rapid repeated triggers from false positives"/>
                        <LineBreak/>
                        <LineBreak/>
                        <Run Text="All four checks must pass for wake word to activate!"/>
                    </TextBlock>

                    <TextBlock Style="{StaticResource SubheaderText}"
                               Text="ðŸ“¸ Position Capture Technology"
                               FontSize="16"
                               Margin="0,0,0,8"/>
                    <TextBlock Style="{StaticResource BodyText}"
                               TextWrapping="Wrap"
                               Margin="0,0,0,16">
                        <Run Text="â€¢ Captures absolute screen coordinates (X, Y pixels)"/>
                        <LineBreak/>
                        <Run Text="â€¢ Works across multiple monitors"/>
                        <LineBreak/>
                        <Run Text="â€¢ Positions stored persistently in settings.json"/>
                        <LineBreak/>
                        <Run Text="â€¢ Falls back to default offsets if not configured"/>
                        <LineBreak/>
                        <Run Text="â€¢ Re-capture if ChatGPT UI changes or resolution changes"/>
                    </TextBlock>

                    <TextBlock Style="{StaticResource SubheaderText}"
                               Text="ðŸ”µ Blue Orb Detection"
                               FontSize="16"
                               Margin="0,0,0,8"/>
                    <TextBlock Style="{StaticResource BodyText}"
                               TextWrapping="Wrap">
                        <Run Text="â€¢ Takes screenshot after clicking Voice Mode button"/>
                        <LineBreak/>
                        <Run Text="â€¢ Scans center region for blue-colored pixels"/>
                        <LineBreak/>
                        <Run Text="â€¢ Verifies >15% of scanned area is blue"/>
                        <LineBreak/>
                        <Run Text="â€¢ Provides confidence that voice mode activated"/>
                        <LineBreak/>
                        <Run Text="â€¢ Note: Detection may fail if ChatGPT UI changes"/>
                    </TextBlock>
                </StackPanel>
            </Border>

            <!-- Keyboard Shortcuts -->
            <Border Style="{StaticResource WabiSabiCard}" Margin="0,0,0,24">
                <StackPanel>
                    <TextBlock Text="âŒ¨ï¸ Tips &amp; Tricks"
                               Style="{StaticResource HeaderText}"
                               FontSize="24"
                               Foreground="{StaticResource PrimaryBrush}"
                               Margin="0,0,0,16"/>

                    <TextBlock Style="{StaticResource BodyText}"
                               TextWrapping="Wrap"
                               Margin="0,0,0,8">
                        <Run Text="â€¢ System Tray:" FontWeight="Bold"/>
                        <Run Text=" Application minimizes to system tray (bottom-right corner)"/>
                    </TextBlock>

                    <TextBlock Style="{StaticResource BodyText}"
                               TextWrapping="Wrap"
                               Margin="0,0,0,8">
                        <Run Text="â€¢ Right-Click Tray Icon:" FontWeight="Bold"/>
                        <Run Text=" Quick access to Show, Settings, or Exit"/>
                    </TextBlock>

                    <TextBlock Style="{StaticResource BodyText}"
                               TextWrapping="Wrap"
                               Margin="0,0,0,8">
                        <Run Text="â€¢ Activity Log:" FontWeight="Bold"/>
                        <Run Text=" Scroll to see full history of events and rejections"/>
                    </TextBlock>

                    <TextBlock Style="{StaticResource BodyText}"
                               TextWrapping="Wrap"
                               Margin="0,0,0,8">
                        <Run Text="â€¢ Settings Persistence:" FontWeight="Bold"/>
                        <Run Text=" All settings saved to %APPDATA%\ChatGptVoiceAssistant\settings.json"/>
                    </TextBlock>

                    <TextBlock Style="{StaticResource BodyText}"
                               TextWrapping="Wrap"
                               Margin="0,0,0,8">
                        <Run Text="â€¢ Debug Screenshots:" FontWeight="Bold"/>
                        <Run Text=" OCR debug images saved to same folder for troubleshooting"/>
                    </TextBlock>

                    <TextBlock Style="{StaticResource BodyText}"
                               TextWrapping="Wrap">
                        <Run Text="â€¢ Disable Isolation:" FontWeight="Bold"/>
                        <Run Text=" Uncheck isolation to revert to basic wake word detection"/>
                    </TextBlock>
                </StackPanel>
            </Border>

            <!-- Footer -->
            <Border Background="{StaticResource BackgroundBrush}"
                    CornerRadius="12"
                    Padding="24"
                    Margin="0,0,0,24">
                <StackPanel>
                    <TextBlock Text="ðŸ’¡ Need More Help?"
                               Style="{StaticResource HeaderText}"
                               FontSize="20"
                               HorizontalAlignment="Center"
                               Margin="0,0,0,12"/>

                    <TextBlock Style="{StaticResource BodyText}"
                               TextWrapping="Wrap"
                               TextAlignment="Center">
                        <Run Text="Watch the Activity Log in real-time as you use the app."/>
                        <LineBreak/>
                        <Run Text="The system provides detailed feedback about every detection and rejection."/>
                        <LineBreak/>
                        <LineBreak/>
                        <Run Text="For best results, start with default settings and adjust based on the log messages." FontWeight="SemiBold"/>
                    </TextBlock>
                </StackPanel>
            </Border>

            <!-- Close Button -->
            <Button Content="Close Guide"
                    Style="{StaticResource AccentButton}"
                    Click="CloseButton_Click"
                    Padding="48,16"
                    HorizontalAlignment="Center"
                    Margin="0,0,0,32"/>

        </StackPanel>
    </ScrollViewer>
</Window>
